# MorphoDB - Go

Go rewrite of the MorphoDB database, for internal use only.

Serves only HTTP as its meant to be used within a docker network.

## Quick Startup

<b>You will need to setup environment variables before starting up the server.</b> Check them out below.

Clone this repository first, and move into the directory.
To start up the server: (On Linux)
```sh
go run ./main
```


## Build Instructions
```sh
go build . 
```

Docker coming soon.

## Pointers for future developers

Definitions:
1. A *project* is a collection of randomly generated solutions produced by the Morpho Grasshopper Plugin.
2. A *solution* is a set of input and output variables (typically numerical knobs and analysis results associated with names).
3. An *asset* is an image or analysis file generated by the plugin, associated with a particular solution.

All of the above definitions can be found as structs within `morpho-routes/get-routes.go`. If you end up changing these structs, run `go generate morpho-routes` to generate the ffjson bindings for each struct.

This repository is meant to be used on the docker net as a standalone web server *and also* as a local backend for the desktop application, to reduce the amount of code written. So be careful when editing non-http routes and check for compatibility issues with the desktop application.

No HTTPS is implemented either as the server is supposed to sit behind a reverse proxy.

A locustfile is provided to load test the server. Refer to [Locust's Quick Start Guide](https://docs.locust.io/en/stable/quickstart.html) to get started.

## TODO Items:

1. Implement project upload routes.
2. Implement generic auth for future frontend services.

## Environment Variables to set:
| Variable | Purpose |
| -------- | ------- |
| DB_STRING | Path to the SQLite databse on disk |
| AWS_S3_ENDPOINT_URL | URL pointing to the s3 location containing our assets |
| AWS_STORAGE_BUCKET_NAME | Name of the stroage bucket containing our assets |

You can set these variables up on the shell or the dockerfile.

